# MPS (Music Platform Service)
## ë¸”ë¡ì²´ì¸ ê¸°ë°˜ B2B ìŒì› ë¼ì´ë¸ŒëŸ¬ë¦¬ & ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ í”Œë«í¼

MPSëŠ” ê¸°ì—…ë“¤ì´ ìŒì›ì„ ì•ˆì „í•˜ê³  íˆ¬ëª…í•˜ê²Œ ì´ìš©í•  ìˆ˜ ìˆë„ë¡ ë•ëŠ” B2B í”Œë«í¼ì…ë‹ˆë‹¤. ë¸”ë¡ì²´ì¸ ê¸°ìˆ ì„ í™œìš©í•˜ì—¬ ìŒì› ì‚¬ìš© ë‚´ì—­ì„ íˆ¬ëª…í•˜ê²Œ ì¶”ì í•˜ê³ , ìœ íš¨ ì¬ìƒì— ëŒ€í•œ ë¦¬ì›Œë“œ ì‹œìŠ¤í…œì„ ì œê³µí•©ë‹ˆë‹¤.

## ğŸ¯ í•µì‹¬ ê¸°ëŠ¥

### ğŸ“¡ API ê¸°ë°˜ ìŒì› ì„œë¹„ìŠ¤
- **ìŒì› ìŠ¤íŠ¸ë¦¬ë°**: `GET /api/music/{music_id}/play`
- **Range ìš”ì²­ ì§€ì›**: HTTP Range í—¤ë”ë¥¼ í†µí•œ ë¶€ë¶„ ë‹¤ìš´ë¡œë“œ
- **ê°€ì‚¬ ë‹¤ìš´ë¡œë“œ**: `GET /api/lyric/{music_id}/download`
- API í‚¤ ê¸°ë°˜ ì¸ì¦ ë° ê¶Œí•œ ê´€ë¦¬
- ë“±ê¸‰ë³„ ì°¨ë³„í™”ëœ ì„œë¹„ìŠ¤ ì œê³µ
- ì„œë²„ ê¸°ë°˜ ì‹¤ì‹œê°„ ì¬ìƒ ì¶”ì 

### ğŸµ Range ê¸°ë°˜ ì¬ìƒ ì¶”ì  ì‹œìŠ¤í…œ
- **ë‹¨ì¼ API êµ¬ì¡°**: GET ìš”ì²­ë§Œìœ¼ë¡œ ì¬ìƒ ì¶”ì  ì™„ë£Œ
- **Range ìš”ì²­ ë¶„ì„**: í´ë¼ì´ì–¸íŠ¸ì˜ HTTP Range íŒ¨í„´ìœ¼ë¡œ ì¬ìƒ ì§„í–‰ë„ íŒŒì•…
- **ìë™ ì„¸ì…˜ ê´€ë¦¬**: ë¸Œë¼ìš°ì €ì˜ ìì—°ìŠ¤ëŸ¬ìš´ ìŠ¤íŠ¸ë¦¬ë° ë™ì‘ í™œìš©
- **ìœ íš¨ì¬ìƒ íŒì •**: íŒŒì¼ì˜ 60% ì´ìƒ ìš”ì²­ ì‹œ ë¦¬ì›Œë“œ ì§€ê¸‰ ëŒ€ìƒ
- **ì‹¤ì‹œê°„ ì¶”ì **: ê° Range ìš”ì²­ë§ˆë‹¤ ì„œë²„ì—ì„œ ì§„í–‰ë„ ê³„ì‚°

### ğŸ” ë“±ê¸‰ë³„ ì„œë¹„ìŠ¤ ì²´ê³„
- **Free**: ì œí•œëœ ìŒì›, ë¦¬ì›Œë“œ ì—†ìŒ
- **Standard/Business**: ì „ì²´ ìŒì› ì´ìš©, ë¦¬ì›Œë“œ ì§€ê¸‰, ì›”ê°„ êµ¬ë…ì œ

### â›“ï¸ ë¸”ë¡ì²´ì¸ íŠ¸ë˜í‚¹
- ìœ íš¨ ì¬ìƒ ì¡°ê±´: 60ì´ˆ ì´ìƒ ì¬ìƒ ë˜ëŠ” ê°€ì‚¬ íŒŒì¼ ì „ì†¡ ì™„ë£Œ
- Sepolia í…ŒìŠ¤íŠ¸ë„· ê¸°ë°˜ íˆ¬ëª…í•œ ì‚¬ìš© ë‚´ì—­ ê¸°ë¡
- ERC20 í† í° ë¦¬ì›Œë“œ ì‹œìŠ¤í…œ

### ğŸ“Š ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
- ìŒì› ì‚¬ìš© í˜„í™© ì‹¤ì‹œê°„ ì¶”ì 
- ê¸°ì—…ë³„/ìŒì›ë³„ ìƒì„¸ í†µê³„
- ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œë¥¼ í†µí•œ ì¢…í•© ëª¨ë‹ˆí„°ë§

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Client Web    â”‚    â”‚   Admin Web     â”‚    â”‚   External APIs â”‚
â”‚   (Next.js)     â”‚    â”‚   (Next.js)     â”‚    â”‚   (3rd party)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚                      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚            Backend API Server                â”‚
          â”‚              (NestJS)                       â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                     â”‚                       â”‚
    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
    â”‚PostgreSQL â”‚         â”‚Blockchain â”‚         â”‚File Store â”‚
    â”‚ Database  â”‚         â”‚(Sepolia)  â”‚         â”‚  (AWS S3) â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ

### Backend
- **Framework**: NestJS (Node.js)
- **Database**: PostgreSQL with Drizzle ORM
- **Authentication**: JWT, API Key
- **Blockchain**: Ethereum (Sepolia Testnet)
- **Language**: TypeScript

### Frontend
- **Framework**: Next.js 15
- **Styling**: Tailwind CSS
- **Charts**: Chart.js
- **Language**: TypeScript

### DevOps
- **Deployment**: AWS (ì˜ˆì •)
- **Version Control**: Git
- **Package Manager**: npm/pnpm

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
MPS-project/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ backend/                 # NestJS API ì„œë²„
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ db/             # ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ & ì„¤ì •
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ schema/     # Drizzle ìŠ¤í‚¤ë§ˆ ì •ì˜
â”‚   â”‚   â”‚   â”œâ”€â”€ controllers/    # API ì»¨íŠ¸ë¡¤ëŸ¬
â”‚   â”‚   â”‚   â”œâ”€â”€ services/       # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚   â”‚   â””â”€â”€ main.ts         # ì• í”Œë¦¬ì¼€ì´ì…˜ ì—”íŠ¸ë¦¬í¬ì¸íŠ¸
â”‚   â”‚   â””â”€â”€ drizzle/           # ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
â”‚   â””â”€â”€ frontend/
â”‚       â”œâ”€â”€ admin/              # ê´€ë¦¬ì ì›¹ ëŒ€ì‹œë³´ë“œ
â”‚       â””â”€â”€ client/             # í´ë¼ì´ì–¸íŠ¸ ì›¹ í˜ì´ì§€
â””â”€â”€ package.json
```

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### í•µì‹¬ ì—”í‹°í‹°
- **Companies**: ê¸°ì—… ì •ë³´ ë° êµ¬ë… ìƒíƒœ
- **Musics**: ìŒì› ë©”íƒ€ë°ì´í„° ë° íŒŒì¼ ì •ë³´
- **Music_plays**: ìŒì› ì¬ìƒ ê¸°ë¡ ë° ìœ íš¨ì„± ê²€ì¦
- **Rewards**: ë¦¬ì›Œë“œ ì§€ê¸‰ ë‚´ì—­
- **Playlists**: ê¸°ì—…ë³„ ìŒì› ì¬ìƒ ëª©ë¡

### ì£¼ìš” ê´€ê³„
- ê¸°ì—… â†” ìŒì› ì¬ìƒ (N:N)
- ìŒì› â†” ì¹´í…Œê³ ë¦¬/íƒœê·¸ (N:N)
- ì¬ìƒ ê¸°ë¡ â†’ ë¦¬ì›Œë“œ (1:1, ìœ íš¨ ì¬ìƒ ì‹œ)

## ğŸš€ ì‹œì‘í•˜ê¸°

### ì‚¬ì „ ìš”êµ¬ì‚¬í•­
- Node.js 18+
- PostgreSQL 14+
- npm ë˜ëŠ” pnpm

### ê°œë°œ í™˜ê²½ ì„¤ì •

1. **ì €ì¥ì†Œ í´ë¡ **
```bash
git clone https://github.com/Sialsry/MPS-project.git
cd MPS-project
```

2. **ì˜ì¡´ì„± ì„¤ì¹˜**
```bash
npm install
```

3. **í™˜ê²½ ë³€ìˆ˜ ì„¤ì •**
```bash
# .env.local íŒŒì¼ ìƒì„±
cp .env.example .env.local
```

4. **ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •**
```bash
cd apps/backend
npm run db:generate
npm run db:migrate
```

5. **ê°œë°œ ì„œë²„ ì‹¤í–‰**
```bash
# Backend (í¬íŠ¸ 3001)
cd apps/backend
npm run start:dev

# Admin Dashboard (í¬íŠ¸ 4001)
cd apps/frontend/admin
npm run dev
```

## ğŸ“‹ API ì‚¬ìš© ê°€ì´ë“œ

### ì¸ì¦
ëª¨ë“  API ìš”ì²­ì—ëŠ” `x-api-key` í—¤ë”ê°€ í•„ìš”í•©ë‹ˆë‹¤.

### ìŒì› ì¬ìƒ (Range ìš”ì²­ ê¸°ë°˜)

#### ê¸°ë³¸ ì‚¬ìš©ë²•
```http
GET /api/music/{music_id}/play
Headers:
  x-api-key: YOUR_API_KEY

Response Headers:
  X-Session-ID: 12345  # ì¬ìƒ ì„¸ì…˜ ê³ ìœ  ID
  X-Progress: 25       # í˜„ì¬ ì¬ìƒ ì§„í–‰ë„ (%)
```

#### Range ìš”ì²­ ìë™ ì²˜ë¦¬
ë¸Œë¼ìš°ì €ì˜ ì˜¤ë””ì˜¤ í”Œë ˆì´ì–´ëŠ” ìë™ìœ¼ë¡œ HTTP Range ìš”ì²­ì„ ë³´ëƒ…ë‹ˆë‹¤:

```http
GET /api/music/{music_id}/play
Headers:
  x-api-key: YOUR_API_KEY
  Range: bytes=0-1023    # ì²« ë²ˆì§¸ ì²­í¬

Response:
  Status: 206 Partial Content
  Content-Range: bytes 0-1023/5242880
  X-Session-ID: 12345
  X-Progress: 0
```

```http
GET /api/music/{music_id}/play
Headers:
  x-api-key: YOUR_API_KEY
  Range: bytes=1024-2047  # ë‘ ë²ˆì§¸ ì²­í¬

Response:
  Status: 206 Partial Content
  Content-Range: bytes 1024-2047/5242880
  X-Session-ID: 12345
  X-Progress: 15
```

#### ìœ íš¨ì¬ìƒ ìë™ íŒì •
```http
GET /api/music/{music_id}/play
Headers:
  x-api-key: YOUR_API_KEY
  Range: bytes=3145728-  # íŒŒì¼ì˜ 60% ì´ìƒ ìš”ì²­

Response:
  Status: 206 Partial Content
  X-Session-ID: 12345
  X-Progress: 65         # 60% ì´ìƒ â†’ ìë™ìœ¼ë¡œ ìœ íš¨ì¬ìƒ ì²˜ë¦¬
```

### ê°€ì‚¬ ë‹¤ìš´ë¡œë“œ
```http
GET /api/lyric/{music_id}/download
Headers:
  x-api-key: YOUR_API_KEY
```

### í´ë¼ì´ì–¸íŠ¸ êµ¬í˜„ ì˜ˆì‹œ

```html
<!-- ë‹¨ìˆœí•œ HTML ì˜¤ë””ì˜¤ íƒœê·¸ë§Œìœ¼ë¡œ ì¶”ì  ê°€ëŠ¥ -->
<audio controls>
  <source src="/api/music/123/play" type="audio/mpeg">
</audio>

<script>
// ë³„ë„ JavaScript ì½”ë“œ ì—†ì´ ìë™ ì¶”ì 
// ë¸Œë¼ìš°ì €ê°€ Range ìš”ì²­ì„ ìë™ìœ¼ë¡œ ë³´ë‚´ê³ 
// ì„œë²„ì—ì„œ ì¬ìƒ ì§„í–‰ë„ë¥¼ ì‹¤ì‹œê°„ ì¶”ì 
</script>
```

### ê³ ê¸‰ ëª¨ë‹ˆí„°ë§ (ì„ íƒì‚¬í•­)
```javascript
// ì§„í–‰ë„ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§í•˜ë ¤ë©´:
const audio = document.querySelector('audio');
const sessionId = null;

audio.addEventListener('loadstart', async () => {
  // ì²« ë²ˆì§¸ ìš”ì²­ì—ì„œ ì„¸ì…˜ ID ì¶”ì¶œ
  const response = await fetch(audio.src, { 
    method: 'HEAD',
    headers: { 'x-api-key': 'YOUR_API_KEY' }
  });
  sessionId = response.headers.get('X-Session-ID');
  console.log('ì„¸ì…˜ ì‹œì‘:', sessionId);
});

// 60% ì´ìƒ ì¬ìƒ ì‹œ ì„œë²„ì—ì„œ ìë™ìœ¼ë¡œ ìœ íš¨ì¬ìƒ ì²˜ë¦¬ë¨
// í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë³„ë„ ì²˜ë¦¬ ë¶ˆí•„ìš”
```

## ğŸ’° ë¦¬ì›Œë“œ ì‹œìŠ¤í…œ

### ìœ íš¨ ì¬ìƒ ì¡°ê±´
- **ìŒì› ì¬ìƒ**: íŒŒì¼ì˜ 60% ì´ìƒ Range ìš”ì²­ ì‹œ ìë™ ì¸ì •
- **ê°€ì‚¬ ì´ìš©**: íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ
- **ìë™ ì¶”ì **: ì„œë²„ì—ì„œ Range ìš”ì²­ íŒ¨í„´ ë¶„ì„ìœ¼ë¡œ ì§„í–‰ë„ ê³„ì‚°

### Range ê¸°ë°˜ ì¬ìƒ ì¶”ì  ì›ë¦¬
1. **ì´ˆê¸° ìš”ì²­**: í´ë¼ì´ì–¸íŠ¸ê°€ ìŒì› ì¬ìƒ ì‹œì‘
2. **Range ìš”ì²­ë“¤**: ë¸Œë¼ìš°ì €ê°€ ìë™ìœ¼ë¡œ íŒŒì¼ì„ ì²­í¬ ë‹¨ìœ„ë¡œ ìš”ì²­
3. **ì§„í–‰ë„ ê³„ì‚°**: ì„œë²„ì—ì„œ ìš”ì²­ëœ ë°”ì´íŠ¸ ë²”ìœ„ë¡œ ì¬ìƒ ì§„í–‰ë„ ì‚°ì¶œ
4. **ìë™ íŒì •**: 60% ì´ìƒ ì§„í–‰ ì‹œ ìœ íš¨ì¬ìƒìœ¼ë¡œ ìë™ ì²˜ë¦¬

### ì¥ì 
- **êµ¬í˜„ ë‹¨ìˆœì„±**: í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë³„ë„ JavaScript ì½”ë“œ ë¶ˆí•„ìš”
- **ì •í™•ì„±**: ì‹¤ì œ ë‹¤ìš´ë¡œë“œëœ ë°ì´í„° ê¸°ë°˜ ì¶”ì 
- **ìì—°ìŠ¤ëŸ¬ì›€**: ë¸Œë¼ìš°ì €ì˜ ê¸°ë³¸ ë™ì‘ í™œìš©

### ë¦¬ì›Œë“œ ì§€ê¸‰
- **ì£¼ê¸°**: ë§¤ì¼ ìì • ì¼ê´„ ì²˜ë¦¬
- **í† í°**: ERC20 ê¸°ë°˜ ë¦¬ì›Œë“œ í† í°
- **ìš©ë„**: ì›”ê°„ êµ¬ë…ë£Œ í• ì¸
- **íˆ¬ëª…ì„±**: ëª¨ë“  ì§€ê¸‰ ë‚´ì—­ ë¸”ë¡ì²´ì¸ ê¸°ë¡

## ğŸ“Š ëª¨ë‹ˆí„°ë§ & í†µê³„

### ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ
- í˜„ì¬ ì¬ìƒ ì¤‘ì¸ ìŒì› í˜„í™©
- ì¼/ì›”ë³„ ì‚¬ìš©ëŸ‰ í†µê³„
- ê¸°ì—…ë³„ ì´ìš© íŒ¨í„´ ë¶„ì„

### ë¸”ë¡ì²´ì¸ íˆ¬ëª…ì„±
- ëª¨ë“  ìœ íš¨ ì¬ìƒ ë¸”ë¡ì²´ì¸ ê¸°ë¡
- ë¦¬ì›Œë“œ ì§€ê¸‰ ë‚´ì—­ ì¶”ì  ê°€ëŠ¥
- ìœ„ë³€ì¡° ë¶ˆê°€ëŠ¥í•œ ì‚¬ìš© ì¦ëª…

## ğŸ”§ ê°œë°œ ë„êµ¬

### ë°ì´í„°ë² ì´ìŠ¤
```bash
# ìŠ¤í‚¤ë§ˆ ìƒì„±
npm run db:generate

# ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰
npm run db:migrate

# DB ìŠ¤íŠœë””ì˜¤ ì‹¤í–‰
npm run db:studio
```

### í…ŒìŠ¤íŠ¸
```bash
# ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
npm run test

# E2E í…ŒìŠ¤íŠ¸
npm run test:e2e
```

## ğŸ¤ ê¸°ì—¬í•˜ê¸°

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## ğŸ“„ ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” MIT ë¼ì´ì„ ìŠ¤ í•˜ì— ë°°í¬ë©ë‹ˆë‹¤.

## ğŸ“ ì—°ë½ì²˜

- **Repository**: [MPS-project](https://github.com/Sialsry/MPS-project)
- **Issues**: [GitHub Issues](https://github.com/Sialsry/MPS-project/issues)

---

> **Note**: í˜„ì¬ ê°œë°œ ë‹¨ê³„ë¡œ Sepolia í…ŒìŠ¤íŠ¸ë„·ì„ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. ë©”ì¸ë„· ë°°í¬ ì‹œ ë³„ë„ ê³µì§€ ì˜ˆì •ì…ë‹ˆë‹¤.